<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>WIN88 Â· å¨±ä¹ç™¾å®¶ä¹</title>
  <link rel="stylesheet" href="casino.css"/>
</head>
<body>
<header class="topbar">
  <div class="logo">ğŸ´ ç™¾å®¶ä¹</div>
  <div class="wallet">
    ğŸ’° <span id="coin">0</span>
    <button onclick="goHome()">è¿”å›å¤§å…</button>
  </div>
</header>

<section class="hero">
  <h2>ä¸‹æ³¨ï¼ˆå¨±ä¹å¸ï¼‰</h2>
  <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
    <button onclick="setBet('player')">é—²</button>
    <button onclick="setBet('banker')">åº„</button>
    <button onclick="setBet('tie')">å’Œ</button>
    <button class="vip" onclick="deal()">å‘ç‰Œ</button>
  </div>
  <p id="betTip">å½“å‰ä¸‹æ³¨ï¼šæœªé€‰æ‹©ï¼ˆæ¯å±€æ‰£ 100ï¼‰</p>
</section>

<section class="hero">
  <h2>ç‰Œé¢</h2>
  <div style="display:flex;gap:14px;justify-content:center;flex-wrap:wrap;">
    <div class="game-card" style="min-width:260px" >
      <h3>é—² Player</h3>
      <div id="pCards" style="font-size:28px;">â€”</div>
      <p>ç‚¹æ•°ï¼š<span id="pPoint">0</span></p>
    </div>
    <div class="game-card" style="min-width:260px" >
      <h3>åº„ Banker</h3>
      <div id="bCards" style="font-size:28px;">â€”</div>
      <p>ç‚¹æ•°ï¼š<span id="bPoint">0</span></p>
    </div>
  </div>

  <h2 id="result" style="margin-top:16px;">ç­‰å¾…å‘ç‰Œ</h2>

  <div style="margin-top:10px;">
    <p>è·¯å•ï¼ˆæœ€è¿‘ 12 å±€ï¼‰ï¼š</p>
    <div id="road" style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;"></div>
  </div>
</section>

<script>
  // ====== åŸºç¡€é’±åŒ… ======
  let coin = Number(localStorage.getItem("coin") || 1000);
  const coinEl = document.getElementById("coin");
  coinEl.textContent = coin;

  function saveCoin(){
    localStorage.setItem("coin", coin);
    coinEl.textContent = coin;
  }
  function goHome(){ window.location.href = "index.html"; }

  // ====== ç™¾å®¶ä¹é€»è¾‘ï¼ˆå¨±ä¹ç‰ˆï¼Œç®€å•ä½†åƒæ ·ï¼‰======
  const suits = ["â™ ï¸","â™¥ï¸","â™¦ï¸","â™£ï¸"];
  function drawCard(){
    // 0-9 ç‚¹ï¼šA=1, 2-9=æœ¬èº«, 10/J/Q/K=0
    const r = Math.floor(Math.random()*13) + 1;
    let v = r;
    if(r === 1) v = 1;
    else if(r >= 10) v = 0;
    return { r, v, s: suits[Math.floor(Math.random()*4)] };
  }
  function cardText(c){
    const map = {1:"A",11:"J",12:"Q",13:"K"};
    const face = map[c.r] || String(c.r);
    return face + c.s;
  }
  function handPoint(hand){
    return hand.reduce((a,c)=>a+c.v,0) % 10;
  }

  let bet = null;
  function setBet(t){
    bet = t;
    document.getElementById("betTip").textContent = `å½“å‰ä¸‹æ³¨ï¼š${t.toUpperCase()}ï¼ˆæ¯å±€æ‰£ 100ï¼‰`;
  }

  // è·¯å•
  const roadKey = "baccarat_road";
  let road = JSON.parse(localStorage.getItem(roadKey) || "[]");
  renderRoad();

  function pushRoad(w){
    road.unshift(w);
    road = road.slice(0,12);
    localStorage.setItem(roadKey, JSON.stringify(road));
    renderRoad();
  }

  function renderRoad(){
    const box = document.getElementById("road");
    box.innerHTML = "";
    road.forEach(w=>{
      const d = document.createElement("div");
      d.className="card";
      d.style.width="40px";
      d.style.height="40px";
      d.style.borderRadius="12px";
      d.style.display="grid";
      d.style.placeItems="center";
      d.style.fontWeight="900";
      d.textContent = w==="player" ? "é—²" : w==="banker" ? "åº„" : "å’Œ";
      if(w==="tie") d.style.borderColor = "rgba(44,255,210,.7)";
      box.appendChild(d);
    });
  }

  function deal(){
    if(!bet){ alert("è¯·å…ˆé€‰æ‹©ä¸‹æ³¨ï¼šé—² / åº„ / å’Œ"); return; }
    if(coin < 100){ alert("ä½™é¢ä¸è¶³"); return; }

    coin -= 100; // æ¯å±€æˆæœ¬
    saveCoin();

    // åˆå§‹ç‰Œ
    const p = [drawCard(), drawCard()];
    const b = [drawCard(), drawCard()];

    // ç®€åŒ–è¡¥ç‰Œè§„åˆ™ï¼ˆæ¥è¿‘çœŸå®ä½†ä¸è¿½æ±‚å®Œå…¨ä¸€è‡´ï¼‰
    let pPoint = handPoint(p);
    let bPoint = handPoint(b);

    // è‹¥ä»»ä¸€æ–¹å¤©ç”Ÿ 8/9 ç›´æ¥åœ
    if(!(pPoint>=8 || bPoint>=8)){
      // é—²ç‚¹æ•°<=5è¡¥ä¸€å¼ 
      if(pPoint <= 5){
        p.push(drawCard());
        pPoint = handPoint(p);
      }
      // åº„ç‚¹æ•°<=5è¡¥ä¸€å¼ ï¼ˆç®€åŒ–ï¼‰
      if(bPoint <= 5){
        b.push(drawCard());
        bPoint = handPoint(b);
      }
    }

    document.getElementById("pCards").textContent = p.map(cardText).join(" ");
    document.getElementById("bCards").textContent = b.map(cardText).join(" ");
    document.getElementById("pPoint").textContent = pPoint;
    document.getElementById("bPoint").textContent = bPoint;

    // åˆ¤å®šèƒœè´Ÿ
    let win = "tie";
    if(pPoint > bPoint) win = "player";
    if(bPoint > pPoint) win = "banker";

    // æ´¾å½©ï¼ˆå¨±ä¹ï¼‰
    // é—²/åº„ èµ¢ï¼šè¿”è¿˜ 200ï¼ˆå‡€èµš 100ï¼‰ï¼›å’Œèµ¢ï¼šè¿”è¿˜ 800ï¼ˆå‡€èµš 700ï¼‰
    let msg = "";
    if(win === bet){
      if(win === "tie"){
        coin += 800;
        msg = "ğŸ‰ ä½ æŠ¼ä¸­ã€å’Œã€‘ï¼å¤§èµ¢ï¼";
      }else{
        coin += 200;
        msg = "ğŸ‰ ä½ èµ¢äº†ï¼";
      }
    }else{
      msg = "âŒ ä½ è¾“äº†ã€‚";
    }

    saveCoin();
    pushRoad(win);

    document.getElementById("result").textContent =
      `${msg} ç»“æœï¼š${win==="player"?"é—²":win==="banker"?"åº„":"å’Œ"}ï¼ˆä½™é¢ ${coin}ï¼‰`;
  }
</script>
</body>
</html
