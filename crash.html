<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>WIN88 Â· Crash</title>
  <link rel="stylesheet" href="casino.css"/>
</head>
<body>
<header class="topbar">
  <div class="logo">ğŸ’¥ Crash</div>
  <div class="wallet">
    ğŸ’° <span id="coin">0</span>
    <button onclick="goHome()">è¿”å›å¤§å…</button>
  </div>
</header>

<section class="hero">
  <h2>ç¿»å€ä¸­ï¼š<span id="multi">1.00x</span></h2>
  <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
    <button class="vip" onclick="start()">å¼€å§‹ï¼ˆ100ï¼‰</button>
    <button onclick="cashout()">é€€å‡ºå…‘ç°</button>
  </div>
  <p id="msg">æç¤ºï¼šè¶Šä¹…å€æ•°è¶Šé«˜ï¼Œä½†éšæ—¶å¯èƒ½çˆ†ã€‚</p>
</section>

<section class="hero">
  <div class="game-card" style="max-width:520px;margin:0 auto;">
    <h3>å®æ—¶å€æ•°</h3>
    <div style="font-size:46px;font-weight:950" id="big">1.00x</div>
  </div>
</section>

<script>
  let coin = Number(localStorage.getItem("coin") || 1000);
  const coinEl = document.getElementById("coin");
  const multiEl = document.getElementById("multi");
  const bigEl = document.getElementById("big");
  const msgEl = document.getElementById("msg");

  coinEl.textContent = coin;

  let timer = null;
  let mult = 1;
  let running = false;

  function save(){
    localStorage.setItem("coin", coin);
    coinEl.textContent = coin;
  }
  function goHome(){ location.href="index.html"; }

  function start(){
    if(running) return;
    if(coin < 100){ alert("ä½™é¢ä¸è¶³"); return; }

    coin -= 100;
    save();

    running = true;
    mult = 1;
    setUI();

    timer = setInterval(()=>{
      // å¢é•¿
      mult += 0.06 + Math.random()*0.04;

      // çˆ†ç‚¸æ¦‚ç‡éšå€æ•°ä¸Šå‡ï¼ˆæ›´åƒèµŒåœºï¼‰
      const boomChance = Math.min(0.02 + mult*0.01, 0.35);

      if(Math.random() < boomChance){
        stopRun(true);
        return;
      }
      setUI();
    }, 220);

    msgEl.textContent = "è¿›è¡Œä¸­â€¦éšæ—¶é€€å‡ºå…‘ç°ï¼";
  }

  function setUI(){
    const t = mult.toFixed(2) + "x";
    multiEl.textContent = t;
    bigEl.textContent = t;
  }

  function stopRun(boom){
    clearInterval(timer);
    timer = null;
    running = false;

    if(boom){
      msgEl.textContent = "ğŸ’¥ çˆ†äº†ï¼æœ¬å±€å½’é›¶";
      mult = 1;
      setUI();
    }
  }

  function cashout(){
    if(!running){ alert("è¿˜æ²¡å¼€å§‹"); return; }
    clearInterval(timer);
    timer = null;
    running = false;

    const win = Math.floor(100 * mult);
    coin += win;
    save();

    msgEl.textContent = `ğŸ‰ é€€å‡ºæˆåŠŸ +${win}ï¼ˆå€ç‡ ${mult.toFixed(2)}xï¼‰`;
    mult = 1;
    setUI();
  }
</script>
</body>
</html>
